# Отчет по лабораторной работе №1 "Исследование цветовых моделей" `Вариант 4`

## Цель работы

Изучить цветовые модели: RGB, HSV, LAB, переход от одной модели к другой, исследовать цветовой график МКО.

Создать веб-приложение, позволяющее пользователю выбирать, а затем интерактивно менять цвет, показывая при этом его составляющие в трех моделях одновременно.

### Основные требования к приложению

- В интерфейсе дать возможность пользователю задавать точные цвета (поля ввода), выбирать цвета из палитры (аналогично графическим редакторам), плавно изменять цвета (например, ползунки).
- При изменении любой компоненты цвета все остальные представления этого цвета в двух других цветовых моделях пересчитываются автоматически.
- При «некорректных цветах» выдавать некое ненавязчивое предупреждение, что происходит обрезание/округление и т.п.

## Ход работы

### Изучение теоритической базы
- Изучил цветовые модели RGB, HSV, LAB и XYZ.
- Рассмотрел формулы для преобразований между данными цветовыми моделями

### Подготовка к созданию веб-приложения
- Реализовал алгоритмы преобразования между собой цветовых моделей RGB, HSV и LAB
- Составил блок-схему взаимодействия веб-приложения

### Реализация веб-приложения
- Разработал графический интерфейс с использованием ранее реализованных алгоритмов преобразования
- Разработал палитру для выбора цвета, используя библиотеку Canvas API JS
- Добавил адаптивность приложения под различные размеры экранов

## Используемые технологии

[![HTML](https://img.shields.io/badge/HTML-5-orange.svg)](https://developer.mozilla.org/ru/docs/Web/HTML)

[![CSS](https://img.shields.io/badge/CSS-3-blue.svg)](https://developer.mozilla.org/ru/docs/Web/CSS)

[![JavaScript](https://img.shields.io/badge/JavaScript-ES6-yellow.svg)](https://developer.mozilla.org/ru/docs/Web/JavaScript)

[Canvas API](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API)

## Что получилось, что нет

### Успешно реализовано:

**Полный набор преобразований между моделями**:
- Прямое преобразование RGB ↔ HSV
- Преобразование RGB ↔ LAB через промежуточную модель XYZ
- Автоматическая синхронизация всех моделей при изменении любого параметра

**Три способа задания цвета для каждой модели**:
- Интерактивные ползунки для плавного изменения
- Числовые поля для точного ввода значений
- Визуальный выбор через цветовой пикер и палитру

**Пользовательский интерфейс**:
- Интуитивный цветовой пикер с палитрой насыщенности/яркости
- Слайдер оттенка для точной настройки цвета
- HEX-ввод для быстрого задания цвета
- Визуальное отображение текущего выбранного цвета
- Адаптивный дизайн для различных устройств

**Обработка ошибок**:
- Автоматическое ограничение значений в допустимых диапазонах
- Уведомления пользователя о корректировке некорректных значений

### Возникшие сложности:

**Реализация цветового пикера**:
- Сложности с правильной отрисовкой градиентов насыщенности и яркости
- Проблемы позиционирования курсора при изменении размеров экрана
- Обеспечение плавности перетаскивания

**Преобразование LAB ↔ RGB**:
- Сложность математических преобразований через XYZ пространство

**Синхронизация интерфейса**:
- Предотвращение циклических обновлений при изменении значений
- Обеспечение согласованности всех элементов управления

## Как тестировал

1. **Тестирование преобразований**:
    - Проверка известных цветовых соответствий между моделями
    - Тестирование граничных значений (0, 255 для RGB; 0, 100 для HSV/LAB)

2. **Тестирование интерфейса**:
    - Проверка синхронизации ползунков и числовых полей
    - Тестирование отклика цветового пикера на изменения
    - Валидация HEX-ввода и преобразования

3. **Браузерное тестирование**:
    - Chrome, Firefox, Safari, Edge
    - Проверка на мобильных устройствах
    - Тестирование производительности при активном использовании

## Формулы преобразования цветовых моделей

### 1. RGB → HSV

**Нормализация RGB:**
```
r' = R / 255
g' = G / 255  
b' = B / 255
```

**Вычисление максимума и минимума:**
```
max = MAX(r', g', b')
min = MIN(r', g', b')
delta = max - min
```

**Насыщенность и яркость:**
```
S = (max == 0) ? 0 : delta / max
V = max
```

**Оттенок:**
```
if delta == 0:
    H = 0
else if max == r':
    H = 60 × ((g' - b') / delta) mod 6
else if max == g':
    H = 60 × ((b' - r') / delta + 2)
else if max == b':
    H = 60 × ((r' - g') / delta + 4)

if H < 0: H = H + 360
```

### 2. HSV → RGB

**Нормализация HSV:**
```
h' = H / 60
s' = S / 100
v' = V / 100
```

**Промежуточные значения:**
```
C = v' × s'
X = C × (1 - |(h' mod 2) - 1|)
m = v' - C
```

**Определение RGB по секторам:**
```
if 0 ≤ h' < 1:    (r, g, b) = (C, X, 0)
if 1 ≤ h' < 2:    (r, g, b) = (X, C, 0)  
if 2 ≤ h' < 3:    (r, g, b) = (0, C, X)
if 3 ≤ h' < 4:    (r, g, b) = (0, X, C)
if 4 ≤ h' < 5:    (r, g, b) = (X, 0, C)
if 5 ≤ h' < 6:    (r, g, b) = (C, 0, X)
```

**Денормализация:**
```
R = (r + m) × 255
G = (g + m) × 255
B = (b + m) × 255
```

### 3. RGB → LAB (через XYZ)

**Гамма-коррекция RGB:**
```
r_linear = (r' > 0.04045) ? ((r' + 0.055)/1.055)^2.4 : r'/12.92
g_linear = (g' > 0.04045) ? ((g' + 0.055)/1.055)^2.4 : g'/12.92  
b_linear = (b' > 0.04045) ? ((b' + 0.055)/1.055)^2.4 : b'/12.92
```

**Преобразование в XYZ (D65):**
```
X = 0.4124564×r_linear + 0.3575761×g_linear + 0.1804375×b_linear
Y = 0.2126729×r_linear + 0.7151522×g_linear + 0.0721750×b_linear
Z = 0.0193339×r_linear + 0.1191920×g_linear + 0.9503041×b_linear
```

**Нормализация по белому point D65:**
```
x_n = X / 0.95047
y_n = Y / 1.00000
z_n = Z / 1.08883
```

**Преобразование в LAB:**
```
f(t) = (t > 0.008856) ? t^(1/3) : 7.787×t + 16/116

L = 116 × f(y_n) - 16
a = 500 × (f(x_n) - f(y_n))
b = 200 × (f(y_n) - f(z_n))
```

### 4. LAB → RGB (через XYZ)

**Обратное преобразование LAB → XYZ:**
```
f_y = (L + 16) / 116
f_x = a / 500 + f_y
f_z = f_y - b / 200

Y = (f_y > 0.206893) ? f_y^3 : (f_y - 16/116) / 7.787
X = (f_x > 0.206893) ? f_x^3 : (f_x - 16/116) / 7.787  
Z = (f_z > 0.206893) ? f_z^3 : (f_z - 16/116) / 7.787
```

**Денормализация XYZ:**
```
X = X × 0.95047
Y = Y × 1.00000
Z = Z × 1.08883
```

**Преобразование XYZ → RGB:**
```
r_linear = 3.2404542×X - 1.5371385×Y - 0.4985314×Z
g_linear = -0.9692660×X + 1.8760108×Y + 0.0415560×Z
b_linear = 0.0556434×X - 0.2040259×Y + 1.0572252×Z
```

**Обратная гамма-коррекция:**
```
R = (r_linear > 0.0031308) ? 1.055×r_linear^(1/2.4)-0.055 : 12.92×r_linear
G = (g_linear > 0.0031308) ? 1.055×g_linear^(1/2.4)-0.055 : 12.92×g_linear
B = (b_linear > 0.0031308) ? 1.055×b_linear^(1/2.4)-0.055 : 12.92×b_linear

R = R × 255, G = G × 255, B = B × 255
```

## Выводы

1. **Достигнуты цели работы** - создано веб-приложение для исследования цветовых моделей с корректными преобразованиями между RGB, HSV и LAB.

2. **Интерфейс соответствует требованиям** - предоставляет три способа задания цвета для каждой модели, изменение и автоматическую синхронизацию.

3. **Математические преобразования реализованы корректно** - несмотря на сложность формул, особенно для LAB пространства, достигнута достаточная точность вычислений.

4. **Приложение готово к использованию** - работает в основных браузерах и имеет удобный интерфейс.

5. **Основная сложность** заключалась в реализации точных преобразований между цветовыми моделями.